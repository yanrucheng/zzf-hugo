{{/*
  Gallery Row Shortcode
  ---------------------
  A horizontal container for gallery items with consistent height across all items.
  Can contain 1, 2, or 3 items per row.

  Parameters:
  - cols: Number of columns (1-3, optional, defaults to 3) - Grid layout only
  - gap: Gap between items (optional, defaults to 1rem)
  - class: Additional custom classes (optional)
  - ratio-layout: Enable ratio-based layout with uniform row height (optional, defaults to false)
  - width-controlled: Enable width-controlled layout with items fitting within container width (optional, defaults to false)
  - height: Row height for ratio-based layout (optional, defaults to 500px)

  Layout Types:

  1. Grid Layout (default - responsive, even width distribution)
     - Items have the same width (1/N of container)
     - Aspect ratio controls the height of items
     - Best for items with the same aspect ratio
     - NOTE: Different aspect ratios will have different heights in grid layout
  {{< gallery-row cols="2" >}}
    {{< gallery-item src="image1.jpg" ratio="3:2" >}}
    {{< gallery-item src="image2.jpg" ratio="3:2" >}}
  {{< /gallery-row >}}

  2. Ratio-Based Layout (fixed row height, items sized by aspect ratio)
     - Items have the same height (fixed by height parameter)
     - Width is automatically calculated based on aspect ratio
     - Can cause horizontal overflow if container is too narrow
     - Maintains consistent row height
  {{< gallery-row ratio-layout="true" height="600px" >}}
    {{< gallery-item src="image1.jpg" ratio="16:9" >}}
    {{< gallery-item src="image2.jpg" ratio="3:2" >}}
    {{< gallery-item src="image3.jpg" ratio="1:1" >}}
  {{< /gallery-row >}}

  3. Width-Controlled Layout (fixed container width, dynamic height)
     - Items fit within container width without overflow
     - Height is automatically calculated based on aspect ratio and container width
     - Items maintain their aspect ratios
     - Best for responsive designs where horizontal overflow is not desired
  {{< gallery-row width-controlled="true" >}}
    {{< gallery-item src="image1.jpg" ratio="16:9" >}}
    {{< gallery-item src="image2.jpg" ratio="3:2" >}}
    {{< gallery-item src="image3.jpg" ratio="1:1" >}}
  {{< /gallery-row >}}
*/}}
{{- $cols := .Get "cols" | default "3" -}}
{{- $gap := .Get "gap" | default "1" -}}
{{- $class := .Get "class" | default "" -}}
{{- $ratioLayout := .Get "ratio-layout" | default "false" -}}
{{- $width := .Get "width" | default "" -}}
{{- $height := .Get "height" | default "500px" -}}

{{- $colSpan := "grid-cols-3" -}}
{{- if eq $cols "1" -}}
  {{- $colSpan = "grid-cols-1" -}}
{{- else if eq $cols "2" -}}
  {{- $colSpan = "grid-cols-2" -}}
{{- else if eq $cols "3" -}}
  {{- $colSpan = "grid-cols-3" -}}
{{- end -}}

{{- /* Layout selection */ -}}

{{- if eq $ratioLayout "true" -}}
  <div class="gallery-row ratio-layout gap-{{ $gap }} {{ $class }}" style="height: {{ $height }};">
{{- else -}}
  {{- /* Handle width style */ -}}
  {{- $style := slice -}}
  {{- if ne $width "" -}}
    {{- $style = $style | append (printf "width: %s" $width) -}}
  {{- end -}}
  {{- $styleAttr := cond (gt (len $style) 0) (printf "style=\"%s\"" (delimit $style "; ")) "" -}}

  <div class="gallery-row width-controlled gap-{{ $gap }} {{ $class }}" {{ $styleAttr | safeHTMLAttr }}>
{{- end -}}
  {{- .Inner -}}
</div>
