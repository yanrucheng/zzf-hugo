{{/*
{{- -}}
*/}}

{{- $src := .Get "src" -}}
{{- $md := .Get "md" -}}
{{- $custom_class := .Get "class" -}}
{{- with .Page.Resources.Get $src -}}

  <style>
    .parallax-container {
      overflow: hidden;
      height: 50vh;
    }

    .parallax-background {
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url( '{{ . }}' );
      background-size: cover;
      background-position: center;
      z-index: 1; /* Places background behind foreground */
    }

    .foreground-content {
      z-index: 2; /* Places foreground above background */
    }

  </style>

  <div class="parallax-container {{ $custom_class }}">
    <div class="parallax-background"></div>
    <div>
      <div class="foreground-content">
        <!-- Only the text or specific elements allow background to show through -->
        <p>test</p>
      </div>
    </div>
  </div>

  <script>
    window.addEventListener('scroll', function() {
      const backgrounds = document.querySelectorAll('.parallax-background');
      const windowH = window.innerHeight;

      backgrounds.forEach((bg) => {
        // Calculate the percentage of scroll within the bg section
        const bgBox = bg.getBoundingClientRect();
        const bgTop = bgBox.top;
        const bgBottom = bgBox.bottom;

        // Check if the element is in the viewport
        if (bgTop < windowH && bgBottom > 0) {
          const scrollPercentage = bgTop / windowH;
          bg.style.backgroundPositionY = `${scrollPercentage * 50}%`; /* Adjust speed */
        }
      });
    });
  </script>

{{- end -}}
